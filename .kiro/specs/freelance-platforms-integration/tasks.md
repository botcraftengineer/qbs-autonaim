# План реализации: Интеграция фриланс-платформ

## Обзор

Этот план реализации разбивает интеграцию фриланс-платформ на дискретные задачи кодирования. Система разработана для универсальной работы с любой фриланс-площадкой (Kwork.ru, FL.ru, Weblancer.net, Upwork и т.д.) без необходимости в специфичных для платформы API. Подход следует стратегии инкрементальной разработки: схема БД → backend API → фоновые задачи → frontend UI → публичный портал интервью. Каждая задача строится на предыдущей работе с контрольными точками для обеспечения качества.

## Важно: Архитектура веб-интервью

Интервью для фрилансеров реализовано как **веб-чат в реальном времени**, аналогичный существующей интеграции с Telegram:

- **Переиспользование логики**: Те же Inngest события, AI-агенты и алгоритмы скоринга, что и в Telegram
- **Real-time коммуникация**: tRPC subscriptions или Server-Sent Events (SSE) для мгновенной доставки сообщений
- **Универсальные таблицы**: `conversations` и `conversation_messages` используются для обоих источников (Telegram и Web)
- **Адаптация событий**: `telegram/interview.*` → `freelance/interview.*` для веб-источника
- **UI чата**: Полноценный чат-интерфейс с историей сообщений, индикатором печатания и автопрокруткой

Это обеспечивает консистентность опыта интервью независимо от канала (Telegram или веб).

## Задачи

- [x] 1. Схема базы данных и модели
  - Создать таблицу `interview_links` с полями: id, vacancyId, token, isActive, createdAt, expiresAt
  - Создать таблицу `freelance_import_history` с полями: id, vacancyId, importedBy, importMode, platformSource, rawText, parsedCount, successCount, failureCount, createdAt
  - Создать таблицу `platform_config` (опционально) с полями: id, platformCode, platformName, profileUrlPattern, isActive, createdAt
  - Добавить поле `platformProfileUrl` в таблицу `vacancy_responses`
  - Добавить enum поле `importSource` в таблицу `vacancy_responses` со значениями: HH_API, FREELANCE_MANUAL, FREELANCE_LINK
  - Расширить enum `source` вакансий для включения: "kwork", "fl", "weblancer", "upwork"
  - Создать Zod схемы валидации для всех новых таблиц
  - _Требования: 1.1, 1.2, 4.4, 4.5, 9.1, 9.2_

- [ ]* 1.1 Написать тест свойств для уникальности ссылок на интервью
  - **Свойство 1: Уникальность ссылок на интервью**
  - **Проверяет: Требования 1.1**

- [ ]* 1.2 Написать тест свойств для предотвращения дубликатов откликов
  - **Свойство 8: Предотвращение дубликатов**
  - **Проверяет: Требования 4.6**

- [x] 2. Сервис генератора ссылок на интервью
  - [x] 2.1 Реализовать класс `InterviewLinkGenerator` с методами: generateLink, validateLink, deactivateLink
    - Использовать `crypto.randomUUID()` для генерации токенов
    - Хранить ссылки в таблице `interview_links`
    - Возвращать полный формат URL: `https://qbs.app/interview/{token}`
    - _Требования: 1.1, 1.2, 1.3_

  - [ ]* 2.2 Написать тест свойств для связи ссылок
    - **Свойство 2: Связь ссылки на интервью**
    - **Проверяет: Требования 1.2**

  - [ ]* 2.3 Написать тест свойств для валидности ссылки на основе статуса задания
    - **Свойство 3: Валидность ссылки на основе статуса задания**
    - **Проверяет: Требования 1.3, 9.6**

  - [ ]* 2.4 Написать тест свойств для валидации ссылки
    - **Свойство 4: Валидация ссылки**
    - **Проверяет: Требования 3.1, 3.2, 14.1**

- [x] 3. Сервис парсера откликов
  - [x] 3.1 Реализовать класс `ResponseParser` с методами: parseSingle, parseBulk, validateParsedData
    - Использовать regex-паттерны для извлечения email, телефонов, Telegram username
    - Определять URL профилей платформ с настраиваемыми паттернами (Kwork: kwork.ru/user/..., FL.ru: fl.ru/users/..., Weblancer: weblancer.net/users/...)
    - Для массового парсинга разделять по двойным переносам строк или "---"
    - Возвращать оценку уверенности (0-1) на основе извлечённых полей
    - _Требования: 5.2, 5.3, 5.4_

  - [ ]* 3.2 Написать тест свойств для извлечения контактной информации
    - **Свойство 10: Извлечение контактной информации**
    - **Проверяет: Требования 5.3**

  - [ ]* 3.3 Написать тест свойств для пометки низкой уверенности
    - **Свойство 11: Пометка низкой уверенности**
    - **Проверяет: Требования 5.4**

  - [ ]* 3.4 Написать модульные тесты для граничных случаев парсера
    - Тестировать пустой текст, неправильно сформированные email, отсутствующие имена
    - Тестировать различные форматы массового импорта


- [x] 4. tRPC роутер фриланс-платформ - Управление вакансиями
  - [x] 4.1 Создать роутер `freelancePlatforms` в tRPC API
    - Реализовать мутацию `createVacancy`: 
      - Принимать title, description, requirements, platformSource, platformUrl (optional)
      - Создавать запись в таблице `vacancies` с `source: platformSource`
      - Автоматически генерировать ссылку на интервью через `InterviewLinkGenerator`
      - Возвращать созданную вакансию с ссылкой на интервью
    - Реализовать запрос `getVacancies`: 
      - Возвращать все вакансии для workspace (HH.ru + фриланс)
      - Фильтрация по источнику (hh, kwork, fl, weblancer и т.д.)
      - Включать статистику по источникам откликов (HH_API, FREELANCE_MANUAL, FREELANCE_LINK)
    - Реализовать запрос `getVacancyById`: 
      - Возвращать одну вакансию со статистикой
      - Группировать отклики по `importSource`
      - Показывать ссылку на интервью
    - Реализовать мутацию `updateVacancyStatus`: 
      - Изменять статус вакансии (active/paused/closed)
      - При закрытии деактивировать ссылку на интервью
    - _Требования: 9.1, 9.2, 9.3, 9.4, 9.5, 9.6, 9.7, 9.8_

  - [ ]* 4.2 Написать тест свойств для валидации создания вакансии
    - **Свойство 22: Валидация создания вакансии**
    - **Проверяет: Требования 9.2**

  - [ ]* 4.3 Написать тест свойств для расчёта статистики по источникам
    - **Свойство 23: Расчёт статистики**
    - **Проверяет: Требования 9.5, 10.2**

- [x] 5. tRPC роутер фриланс-платформ - Ссылки на интервью
  - [x] 5.1 Реализовать эндпоинты ссылок на интервью
    - Мутация `generateInterviewLink`: создать ссылку для вакансии
    - Запрос `getInterviewLink`: получить ссылку для вакансии
    - Запрос `validateInterviewToken`: проверить валидность токена (публичный эндпоинт)
    - _Требования: 1.1, 1.2, 3.1_

  - [ ]* 5.2 Написать модульные тесты для генерации ссылок
    - Тестировать формат токена (UUID)
    - Тестировать конструирование URL
    - Тестировать ограничение скорости (макс. 1 на вакансию)

- [x] 6. Контрольная точка - Убедиться, что все тесты проходят
  - ✅ Build успешно завершён (bun run build)
  - ✅ TypeScript компиляция без ошибок
  - ✅ Все файлы фриланс-платформ проверены (getDiagnostics)
  - ℹ️ Unit тесты будут созданы в последующих задачах (property-based tests с fast-check)
  - ℹ️ Playwright тесты имеют проблему конфигурации (не связано с нашей реализацией)

- [x] 7. tRPC роутер фриланс-платформ - Ручной импорт
  - [ ] 7.1 Реализовать эндпоинты ручного импорта
    - Мутация `importSingleResponse`: принимать данные фрилансера, platformSource, создавать запись отклика
    - Мутация `importBulkResponses`: принимать сырой текст, platformSource, парсить и импортировать несколько откликов
    - Запрос `previewBulkImport`: парсить текст и возвращать предпросмотр без сохранения
    - _Требования: 4.1, 4.2, 4.3, 4.4, 5.1, 5.2_

  - [ ]* 7.2 Написать тест свойств для валидации обязательных полей
    - **Свойство 5: Валидация обязательных полей**
    - **Проверяет: Требования 4.2, 4.3**

  - [ ]* 7.3 Написать тест свойств для связи импорта
    - **Свойство 6: Связь импорта**
    - **Проверяет: Требования 4.4**

  - [ ]* 7.4 Написать тест свойств для сохранения текста отклика
    - **Свойство 7: Сохранение текста отклика**
    - **Проверяет: Требования 4.5**

  - [ ]* 7.5 Написать тест свойств для отчётности массового импорта
    - **Свойство 12: Отчётность массового импорта**
    - **Проверяет: Требования 5.7**

- [x] 8. Фоновая задача AI-анализа
  - [x] 8.1 Создать Inngest задачу: `freelance.response.analyze`
    - Запускать при событии импорта отклика
    - Переиспользовать существующую логику `screenResume`, адаптировать для текста отклика
    - Извлекать навыки, опыт, квалификацию с использованием GPT-4
    - Генерировать оценку совместимости (0-100)
    - Сохранять результаты в таблице `vacancy_screenings`
    - _Требования: 6.1, 6.2, 6.3, 6.4, 6.5_

  - [ ]* 8.2 Написать тест свойств для запуска анализа
    - **Свойство 13: Запуск анализа**
    - **Проверяет: Требования 6.1**

  - [ ]* 8.3 Написать тест свойств для использования требований в анализе
    - **Свойство 14: Анализ использует требования**
    - **Проверяет: Требования 6.2**

  - [ ]* 8.4 Написать тест свойств для структуры выходных данных анализа
    - **Свойство 15: Структура выходных данных анализа**
    - **Проверяет: Требования 6.3**

  - [ ]* 8.5 Написать тест свойств для валидности диапазона оценки
    - **Свойство 16: Валидность диапазона оценки**
    - **Проверяет: Требования 6.4, 8.1**

- [x] 9. Генератор приглашений на интервью
  - [ ] 9.1 Создать Inngest задачу: `freelance.invitation.generate`
    - Запускать после завершения анализа
    - Проверять, соответствует ли оценка минимальному порогу
    - Генерировать персонализированный текст приглашения со ссылкой на интервью
    - Сохранять запись приглашения с временной меткой
    - _Требования: 7.1, 7.2, 7.3, 7.5_

  - [ ]* 9.2 Написать тест свойств для порога квалификации
    - **Свойство 17: Порог квалификации**
    - **Проверяет: Требования 7.1**

  - [ ]* 9.3 Написать тест свойств для генерации приглашения
    - **Свойство 18: Генерация приглашения для квалифицированных кандидатов**
    - **Проверяет: Требования 7.2, 7.3**

  - [ ]* 9.4 Написать тест свойств для отслеживания приглашений
    - **Свойство 19: Отслеживание приглашений**
    - **Проверяет: Требования 7.5**

- [ ] 10. Контрольная точка - Убедиться, что все тесты проходят
  - Убедиться, что все тесты проходят, спросить пользователя, если возникнут вопросы.

- [x] 11. Публичный портал интервью - Целевая страница
  - [x] 11.1 Создать Next.js страницу: `/interview/[token]/page.tsx`
    - Валидировать токен с использованием tRPC запроса
    - Отображать название вакансии и информацию о компании
    - Показывать инструкции по интервью и примерное время
    - Рендерить форму информации о фрилансере:
      - Имя (обязательно)
      - Email (обязательно)
      - **URL профиля на платформе (обязательно)** - с placeholder примерами для разных платформ
      - Телефон (опционально)
      - Telegram username (опционально)
    - Валидировать URL профиля на платформе (regex для kwork.ru, fl.ru, weblancer.net и т.д.)
    - Проверять дубликаты по `platformProfileUrl` + `vacancyId` перед началом интервью
    - Добавить кнопку "Начать интервью"
    - _Требования: 2.3, 3.1, 3.2, 3.3, 3.4, 3.5, 3.6_

  - [ ]* 11.2 Написать модульный тест для рендеринга целевой страницы
    - Тестировать с валидным токеном
    - Тестировать с невалидным токеном (должна показать ошибку)
    - Тестировать валидацию URL профиля на платформе

- [x] 12. Публичный портал интервью - UI веб-чата
  - [x] 12.1 Создать компоненты интерфейса чата ✅
    - ✅ Компонент списка сообщений с автопрокруткой (`ChatMessageList`)
    - ✅ Компонент ввода текстового сообщения с кнопкой отправки (`ChatInput`)
    - ✅ Индикатор "бот печатает..." при обработке (`TypingIndicator`)
    - ✅ Отображение временных меток сообщений (`ChatMessage`)
    - ✅ Адаптивный дизайн для мобильных устройств (responsive Tailwind classes)
    - ✅ Accessibility: ARIA labels, semantic HTML, keyboard support
    - ✅ Mobile-friendly: 48px touch targets, 16px font size, touch-action manipulation
    - _Требования: 3.4, 3.5_

  - [x] 12.2 Реализовать real-time коммуникацию
    - Создать tRPC subscription или SSE эндпоинт для получения сообщений от бота
    - Реализовать polling как fallback для старых браузеров
    - Автоматическое переподключение при потере соединения
    - _Требования: 3.4_

  - [x] 12.3 Адаптировать систему буферизации для веб-чата
    - Переименовать `telegram_interview_scoring` → `interview_scoring` (универсальная таблица)
    - Добавить поле `source: 'TELEGRAM' | 'WEB'` в таблицу `conversations`
    - Переиспользовать существующий `PostgresMessageBufferService` и таблицу `buffered_messages`
    - Создать Inngest события: `interview/buffer.debounce` и `interview/buffer.flush` для веб-источника
    - Адаптировать `bufferDebounceFunction` и `bufferFlushFunction` для работы с веб-чатом
    - Настроить debounce timeout через env: `INTERVIEW_BUFFER_DEBOUNCE_MS` (по умолчанию 3000ms)
    - _Требования: 3.4, 3.5_

  - [x] 12.4 Создать tRPC эндпоинты для веб-чата с буферизацией
    - Мутация `startWebInterview`: 
      - Принимать token, FreelancerInfo (name, email, platformProfileUrl, phone?, telegram?)
      - Валидировать token и проверить, что вакансия активна
      - Валидировать формат platformProfileUrl (regex для kwork.ru, fl.ru, weblancer.net)
      - Проверить дубликаты по `platformProfileUrl` + `vacancyId`
      - Создать `vacancy_response` с `importSource: 'FREELANCE_LINK'`
      - Создать conversation с source='WEB'
      - Вернуть conversationId и первое приветственное сообщение
    - Мутация `sendChatMessage`: 
      - Сохранить сообщение фрилансера в `conversation_messages`
      - Добавить сообщение в буфер через `messageBufferService.addMessage()`
      - Запустить событие `interview/buffer.debounce` с debounce таймером
      - Вернуть успех (не ждать ответа AI)
    - Subscription `subscribeToChatMessages`: real-time поток сообщений от бота (только sender='BOT')
    - Запрос `getChatHistory`: получить историю сообщений conversation
    - Запрос `getWebInterviewStatus`: получить текущий статус интервью и наличие буфера
    - _Требования: 3.3, 3.4, 3.5, 3.8_

  - [x] 12.5 Реализовать UI состояния буферизации
    - Хранить сообщения в `conversation_messages` (переиспользование существующей таблицы)
    - Автосохранение каждого сообщения
    - Восстановление истории при перезагрузке страницы
    - Показывать индикатор "обрабатывается..." после отправки сообщения (пока буфер активен)
    - Показывать индикатор "бот печатает..." при получении ответа от AI
    - Отключать поле ввода во время обработки буфера (опционально)
    - Использовать `getWebInterviewStatus` для проверки наличия активного буфера
    - _Требования: 3.4, 3.5, 3.8_

  - [ ]* 12.6 Написать интеграционный тест для полного потока веб-интервью
    - Начать интервью → отправить несколько сообщений → получить ответы бота → проверить завершение

- [x] 13. Генератор шортлиста
  - [x] 13.1 Реализовать логику генерации шортлиста
    - Создать класс `ShortlistGenerator` с методом `generateShortlist`
    - Комбинировать оценку анализа отклика (40%) + оценку интервью (60%)
    - Если нет интервью, использовать только оценку анализа отклика
    - Сортировать по комбинированной оценке по убыванию
    - Фильтровать по минимальному порогу оценки
    - Возвращать топ N кандидатов
    - _Требования: 8.1, 8.2, 8.4_

  - [ ]* 13.2 Написать тест свойств для ранжирования шортлиста
    - **Свойство 20: Ранжирование шортлиста**
    - **Проверяет: Требования 8.2**

  - [ ]* 13.3 Написать тест свойств для фильтрации по порогу оценки
    - **Свойство 21: Фильтрация по порогу оценки**
    - **Проверяет: Требования 8.4**

  - [x] 13.4 Создать tRPC эндпоинт: `getShortlist`
    - Принимать vacancyId и опции (minScore, maxCandidates, sortBy)
    - Возвращать ранжированный список кандидатов с особенностями
    - _Требования: 8.1, 8.2, 8.4_

- [ ] 14. Контрольная точка - Убедиться, что все тесты проходят
  - Убедиться, что все тесты проходят, спросить пользователя, если возникнут вопросы.

- [x] 15. Фронтенд - UI управления заданиями
  - [x] 15.1 Создать страницу списка заданий на фриланс-платформах
    - Отображать все задания на фриланс-платформах в таблице/карточках
    - Показывать ключевую статистику: отклики, интервью, размер шортлиста
    - Добавить фильтры: статус (active/paused/closed), диапазон дат, источник платформы (Kwork, FL.ru, Weblancer и т.д.)
    - Добавить кнопку "Создать задание"
    - _Требования: 9.1, 10.1_

  - [x] 15.2 Создать форму создания задания
    - Поля ввода: название, описание, требования, выпадающий список источника платформы, URL платформы
    - Валидация с использованием Zod схемы
    - Отправка в мутацию `createJob`
    - Перенаправление на страницу деталей задания при успехе
    - _Требования: 9.1, 9.2_

  - [ ] 15.3 Создать страницу деталей задания
    - Отображать информацию о задании и источник платформы
    - Показывать ссылку на интервью с кнопкой копирования в буфер обмена
    - Отображать шаблонный текст для описания задания на фриланс-платформе
    - Показывать секцию импорта откликов
    - Показывать секцию шортлиста
    - _Требования: 1.4, 1.5, 2.4, 9.3, 9.4_

- [ ] 16. Фронтенд - UI ручного импорта
  - [ ] 16.1 Создать компонент формы ручного импорта
    - Переключение между одиночным и массовым режимом
    - Текстовая область для вставки данных откликов
    - Кнопка "Парсить" для предпросмотра распарсенных данных
    - Редактируемая таблица предпросмотра
    - Кнопка "Импортировать" для подтверждения
    - _Требования: 4.1, 5.1, 5.5, 5.6_

  - [ ] 16.2 Реализовать логику предпросмотра импорта
    - Вызывать запрос `previewBulkImport` при парсинге
    - Отображать распарсенные данные в таблице с оценками уверенности
    - Выделять поля с низкой уверенностью для проверки
    - Позволить встроенное редактирование распарсенных данных
    - _Требования: 5.4, 5.5, 5.6_

  - [ ] 16.3 Реализовать отправку импорта
    - Вызывать мутацию `importBulkResponses`
    - Показывать toast-уведомления об успехе/ошибке
    - Отображать сводку импорта (количество успехов, количество неудач)
    - _Требования: 4.7, 5.7_

- [ ] 17. Фронтенд - UI шортлиста
  - [ ] 17.1 Создать компонент просмотра шортлиста
    - Отображать ранжированных кандидатов в карточках/таблице
    - Показывать оценку, особенности, контактную информацию
    - Добавить фильтры: минимальная оценка, порядок сортировки
    - Добавить кнопку экспорта (CSV/PDF)
    - _Требования: 8.3, 8.4, 8.6_

  - [ ] 17.2 Реализовать фильтрацию шортлиста
    - Клиентская фильтрация по порогу оценки
    - Пересортировка по различным критериям (оценка, опыт, дата)
    - _Требования: 8.4_

  - [ ] 17.3 Реализовать экспорт шортлиста
    - Генерировать CSV с данными кандидатов
    - Запускать скачивание по нажатию кнопки
    - _Требования: 8.6_

- [ ] 18. Дашборд и аналитика
  - [ ] 18.1 Создать страницу дашборда фриланс-платформ
    - Отображать обзорные метрики: всего заданий, всего откликов, средний коэффициент завершения
    - Показывать список заданий с ключевой статистикой
    - Добавить фильтры: диапазон дат, статус, источник платформы (Kwork, FL.ru, Weblancer и т.д.)
    - Выделять задания, требующие внимания
    - _Требования: 10.1, 10.2, 10.3, 10.4, 10.5_

  - [ ]* 18.2 Написать тест свойств для расчёта коэффициента конверсии
    - **Свойство 24: Расчёт коэффициента конверсии**
    - **Проверяет: Требования 10.3, 15.2**

  - [ ]* 18.3 Написать тест свойств для генерации оповещений
    - **Свойство 25: Генерация оповещений о незавершённой работе**
    - **Проверяет: Требования 10.4**

  - [ ]* 18.4 Написать тест свойств для фильтрации дашборда
    - **Свойство 26: Фильтрация дашборда**
    - **Проверяет: Требования 10.5**

  - [ ] 18.5 Создать страницу аналитики
    - Отображать метрику времени до шортлиста
    - Показывать коэффициент завершения интервью
    - Отображать график распределения оценок
    - Сравнивать метрики между различными фриланс-платформами (Kwork vs FL.ru vs Weblancer)
    - Сравнивать метрики фриланс-платформ vs HeadHunter
    - Добавить кнопку экспорта аналитических данных
    - _Требования: 15.1, 15.2, 15.3, 15.4, 15.5, 15.6_

  - [ ]* 18.6 Написать тест свойств для отслеживания времени до шортлиста
    - **Свойство 34: Отслеживание времени до шортлиста**
    - **Проверяет: Требования 15.1**

  - [ ]* 18.7 Написать тест свойств для расчёта распределения оценок
    - **Свойство 35: Расчёт распределения оценок**
    - **Проверяет: Требования 15.3**

  - [ ]* 18.8 Написать тест свойств для сравнения метрик между платформами
    - **Свойство 36: Сравнение метрик между платформами**
    - **Проверяет: Требования 15.4**

  - [ ]* 18.9 Написать тест свойств для сравнения метрик между источниками
    - **Свойство 37: Сравнение метрик между источниками**
    - **Проверяет: Требования 15.5**

- [ ] 19. Система уведомлений
  - [ ] 19.1 Создать Inngest задачу: `freelance.notification.send`
    - Запускать при завершении интервью
    - Запускать при выявлении высокооценённого кандидата
    - Группировать уведомления в пределах 5-минутного окна
    - Отправлять через email, в приложении или Telegram на основе предпочтений
    - Включать прямую ссылку на профиль фрилансера
    - _Требования: 11.1, 11.2, 11.4, 11.5_

  - [ ]* 19.2 Написать тест свойств для уведомления о завершении интервью
    - **Свойство 27: Уведомление о завершении интервью**
    - **Проверяет: Требования 11.1**

  - [ ]* 19.3 Написать тест свойств для приоритетного уведомления о высокой оценке
    - **Свойство 28: Приоритетное уведомление о высокой оценке**
    - **Проверяет: Требования 11.2**

  - [ ]* 19.4 Написать тест свойств для группировки уведомлений
    - **Свойство 29: Группировка уведомлений**
    - **Проверяет: Требования 11.4**

  - [ ]* 19.5 Написать тест свойств для содержимого уведомления
    - **Свойство 30: Содержимое уведомления**
    - **Проверяет: Требования 11.5**

- [ ] 20. Безопасность и логирование аудита
  - [ ] 20.1 Реализовать логирование доступа к персональным данным
    - Создать middleware логирования аудита
    - Логировать все обращения к персональным данным фрилансеров
    - Хранить: временную метку, userId, действие, resourceId
    - _Требования: 12.5_

  - [ ]* 20.2 Написать тест свойств для логирования доступа к персональным данным
    - **Свойство 31: Логирование доступа к персональным данным**
    - **Проверяет: Требования 12.5**

  - [ ] 20.3 Реализовать очистку данных при удалении задания
    - Добавить диалог подтверждения для удаления задания
    - Предложить опции: анонимизировать или удалить данные фрилансеров
    - Выполнить очистку на основе выбора пользователя
    - _Требования: 12.4_

- [ ] 21. Обработка ошибок и восстановление
  - [ ] 21.1 Реализовать обработку ошибок для всех tRPC эндпоинтов
    - Возвращать соответствующие HTTP коды статуса
    - Предоставлять конкретные сообщения об ошибках
    - Логировать ошибки для отладки
    - _Требования: 14.1, 14.2, 14.3, 14.5_

  - [ ]* 21.2 Написать тест свойств для деталей ошибок массового импорта
    - **Свойство 32: Детали ошибок массового импорта**
    - **Проверяет: Требования 14.3**

  - [ ]* 21.3 Написать тест свойств для уведомления о критической ошибке
    - **Свойство 33: Уведомление о критической ошибке**
    - **Проверяет: Требования 14.5**

  - [ ] 21.4 Реализовать механизмы повтора
    - Добавить кнопку ручного повтора для неудачного AI-анализа
    - Добавить повтор для неудачных записей массового импорта
    - Реализовать экспоненциальную задержку для ошибок AI-сервиса
    - _Требования: 6.6, 14.2_

- [ ] 22. Финальная контрольная точка - Интеграционное тестирование
  - [ ] 22.1 Тестировать полный сквозной поток
    - Создать задание на фриланс-платформе (тестировать с Kwork, FL.ru, Weblancer) → сгенерировать ссылку на интервью → импортировать отклики → запустить анализ → сгенерировать приглашения → завершить интервью → просмотреть шортлист
    - Проверить, что все данные корректно сохранены и отображены
    - Тестировать сценарии ошибок и восстановление

  - [ ] 22.2 Тестирование производительности
    - Тестировать массовый импорт с 100+ откликами
    - Тестировать дашборд с 50+ заданиями на нескольких платформах
    - Проверить приемлемое время загрузки страниц

  - [ ] 22.3 Тестирование мобильной адаптивности
    - Тестировать портал интервью на мобильных устройствах
    - Тестировать форму ручного импорта на мобильных
    - Тестировать вид шортлиста на мобильных

- [ ] 23. Документация и развёртывание
  - [ ] 23.1 Создать пользовательскую документацию
    - Написать руководство по созданию заданий на фриланс-платформах
    - Написать руководство по импорту откликов с различных платформ
    - Написать руководство по интерпретации шортлистов
    - Добавить раздел FAQ

  - [ ] 23.2 Обновить документацию API
    - Документировать все новые tRPC эндпоинты
    - Добавить примеры для каждого эндпоинта
    - Документировать коды ошибок и ответы

  - [ ] 23.3 Подготовка к развёртыванию
    - Обновить переменные окружения
    - Запустить миграции базы данных
    - Развернуть в staging окружение
    - Выполнить smoke-тесты

## Примечания

- Задачи, помеченные `*`, являются опциональными и могут быть пропущены для более быстрого MVP
- Каждая задача ссылается на конкретные требования для отслеживаемости
- Контрольные точки обеспечивают инкрементальную валидацию
- Тесты свойств проверяют универсальные свойства корректности с использованием fast-check
- Модульные тесты проверяют конкретные примеры и граничные случаи
- Интеграционные тесты проверяют сквозные рабочие процессы
- Система разработана для работы с любой фриланс-платформой (Kwork.ru, FL.ru, Weblancer.net, Upwork и т.д.)
- Специфичная для платформы логика минимальна и настраивается через базу данных или конфигурационные файлы
